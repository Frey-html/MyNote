在 Makefile 中，`*` 和 `%` 都可以用于模式匹配和通配符匹配，但它们的**使用场景**和**功能**有所不同。下面我来详细解释它们的区别：

### 1. `*` —— 通配符（Wildcard）

`*` 是通配符，用来匹配**文件名**中的任意字符。它的作用与 Linux Shell 中的 `*` 类似，可以匹配一个或多个字符。主要用于寻找符合模式的文件。

#### 用法场景：查找符合条件的文件

**示例：**
```makefile
SRCS := $(wildcard *.c)
```

- 这里的 `*.c` 匹配当前目录下**所有以 `.c` 结尾的文件**，并将这些文件的名字赋值给 `SRCS` 变量。
- 假设当前目录下有 `main.c`、`utils.c` 等文件，那么 `SRCS` 的值就是 `main.c utils.c`。

#### 例子中的匹配：
- `*.c`：匹配所有 `.c` 结尾的文件，比如 `main.c`、`utils.c` 等。
- `*` 可以匹配任意长度的字符，包括零长度（即可以匹配任何文件）。

#### 总结 `*` 的特点：
- **匹配文件名**。
- 通常和 `$(wildcard)` 或 `$(shell)` 函数一起使用，用来查找符合条件的文件。

### 2. `%` —— 模式规则中的通配符（Pattern Rule）

`%` 是在 Makefile 中的模式规则（Pattern Rules）中使用的通配符，用来表示一个**模式**。它匹配任意数量的字符，用于为一类文件定义通用规则。

#### 用法场景：定义规则时使用，生成目标或依赖

**示例：**
```makefile
%.o: %.c
	$(CC) -c $< -o $@
```

- 这里的 `%.o: %.c` 是一个**模式规则**，表示**所有 `.c` 文件**都可以通过这条规则编译为对应的 `.o` 文件。
- **`%`** 匹配任意长度的字符串，`%.o` 匹配目标文件，`%.c` 匹配源文件。例如，`main.c` 会通过该规则生成 `main.o`，`utils.c` 会生成 `utils.o`。

#### 例子中的匹配：
- `%.o`：匹配所有 `.o` 目标文件。
- `%.c`：匹配所有 `.c` 源文件。
- 当遇到 `main.o` 作为目标时，Makefile 会自动将 `%` 替换为 `main`，然后从 `main.c` 编译生成 `main.o`。

#### 总结 `%` 的特点：
- **用于模式规则**（Pattern Rules），匹配目标和依赖的模式。
- `%` 匹配目标文件名中的一部分，可以配合规则让 Makefile 自动处理多个文件类型之间的转换（如 `.c` 到 `.o`）。

### 3. `*` 与 `%` 的主要区别

| 特性        | `*`（通配符）            | `%`（模式规则中的通配符）    |
|-------------|--------------------------|------------------------------|
| 用途        | 匹配文件名，查找符合条件的文件 | 用于模式规则，匹配文件的模式 |
| 场景        | 常用于 `$(wildcard)` 等函数中 | 用于定义规则的目标和依赖    |
| 作用        | 匹配文件名中任意长度的字符 | 在规则中匹配目标和依赖中的模式 |
| 例子        | `$(wildcard *.c)`         | `%.o: %.c`                   |

### 4. 综合示例

结合两者使用，可以更好理解它们的区别：

```makefile
SRCS := $(wildcard *.c)    # 使用 * 来匹配所有 .c 文件
OBJS := $(SRCS:.c=.o)      # 将所有 .c 文件名替换为 .o 文件

# 使用 % 来定义从 .c 到 .o 的模式规则
%.o: %.c
	$(CC) -c $< -o $@

all: $(OBJS)
	$(CC) -o my_program $(OBJS)
```

- `SRCS := $(wildcard *.c)`：使用 `*` 来匹配当前目录下所有 `.c` 文件。
- `OBJS := $(SRCS:.c=.o)`：将 `.c` 文件名替换为 `.o`。
- `%.o: %.c`：定义模式规则，使用 `%` 来自动处理 `.c` 文件到 `.o` 文件的编译过程。

在这个 Makefile 中：
- `*` 用于查找文件名。
- `%` 用于规则中匹配文件名中的模式，从 `.c` 文件生成 `.o` 文件。

### 总结

- **`*`（通配符）**：主要用于查找文件名，匹配任意数量的字符。在 Makefile 中通常与 `$(wildcard)` 等函数结合使用，来获取文件列表。
- **`%`（模式规则中的通配符）**：用于定义模式规则，在规则中匹配目标文件和依赖文件的模式，主要用来为一类文件（如 `.c` 到 `.o` 的转换）定义通用规则。

它们的使用场景不同，但都是用来匹配文件名的一部分。在 Makefile 中，`*` 用于查找文件，而 `%` 则用于模式规则中的自动匹配。

### 常见通配符
在 Makefile 中，除了 `*` 和 `%` 之外，还有其他常用的通配符和特殊符号，它们可以用来进行模式匹配、文件操作和字符串处理。以下是一些常见的通配符及其用法：

#### 1. **`*`（星号）**

- **作用**：匹配任意长度的字符，包括零个字符。
- **使用场景**：常用于查找符合条件的文件名，类似于 shell 的通配符。

**示例：**
```makefile
SRCS := $(wildcard *.c)
```
匹配当前目录下所有 `.c` 文件，如 `main.c`、`foo.c` 等。

#### 2. **`?`（问号）**

- **作用**：匹配**单个字符**。
- **使用场景**：匹配一个任意字符，常用于文件名中有变动的某个字符时。

**示例：**
```makefile
SRCS := $(wildcard ?.c)
```
匹配当前目录下只有一个字符长度的 `.c` 文件，如 `a.c`、`b.c` 等。

#### 3. **`[...]`（方括号）**

- **作用**：匹配方括号内的**任意一个字符**。类似于正则表达式中的字符集。
- **使用场景**：用于匹配文件名中的特定字符范围或集合。

**示例：**
```makefile
SRCS := $(wildcard [ab]*.c)
```
匹配当前目录下以 `a` 或 `b` 开头的 `.c` 文件，如 `apple.c`、`banana.c`。

**字符范围**：
```makefile
SRCS := $(wildcard file[1-9].c)
```
匹配文件名为 `file1.c` 到 `file9.c` 的 `.c` 文件。

#### 4. **`%`（百分号）**

- **作用**：在 Makefile 的**模式规则**中使用，匹配目标和依赖中的**模式部分**，用于文件名模式匹配。
- **使用场景**：常用于模式规则中，定义通用的文件转换规则。

**示例：**
```makefile
%.o: %.c
	$(CC) -c $< -o $@
```
`%` 匹配任意文件名，`.c` 文件将被编译为对应的 `.o` 文件。

#### 5. **`$(wildcard PATTERN)`**

- **作用**：`wildcard` 函数用于匹配符合某个模式的所有文件。
- **使用场景**：常用于获取当前目录下或指定目录下符合某个模式的文件列表。

**示例：**
```makefile
FILES := $(wildcard src/*.c)
```
匹配 `src/` 目录下的所有 `.c` 文件。

#### 6. **`$(patsubst PATTERN, REPLACEMENT, TEXT)`**

- **作用**：`patsubst` 函数用于根据模式替换字符串中的部分内容。
- **使用场景**：常用于从源文件名生成目标文件名。

**示例：**
```makefile
OBJS := $(patsubst %.c, %.o, $(SRCS))
```
将 `.c` 文件名替换为 `.o`，如 `main.c` 替换为 `main.o`。

#### 7 . **`$(subst FROM, TO, TEXT)`**

- **作用**：`subst` 函数用于简单的字符串替换。
- **使用场景**：用于替换字符串中的部分内容，而不依赖文件名的模式匹配。

**示例：**
```makefile
FILES := $(subst src/, build/, $(SRCS))
```
将 `src/` 目录中的文件路径替换为 `build/` 目录。

#### 8. **`$(filter PATTERN..., TEXT)`**

- **作用**：`filter` 函数用于从字符串中过滤出符合某个模式的部分。
- **使用场景**：常用于从多个文件或字符串中筛选出符合特定条件的子集。

**示例：**
```makefile
CFILES := $(filter %.c, $(FILES))
```
从 `FILES` 中筛选出所有 `.c` 文件。

#### 9. **`$(filter-out PATTERN..., TEXT)`**

- **作用**：`filter-out` 函数用于从字符串中移除符合某个模式的部分。
- **使用场景**：用于排除不符合条件的文件或字符串。

**示例：**
```makefile
NON_CFILES := $(filter-out %.c, $(FILES))
```
从 `FILES` 中移除所有 `.c` 文件，保留其他类型的文件。

#### 10. **`$(findstring FIND, TEXT)`**

- **作用**：`findstring` 函数用于在 `TEXT` 中查找 `FIND` 字符串。如果找到则返回 `FIND`，否则返回空。
- **使用场景**：用于条件判断，检查某个字符串是否包含特定子字符串。

**示例：**
```makefile
ifeq ($(findstring debug, $(CFLAGS)), debug)
	CFLAGS += -g
endif
```
如果 `CFLAGS` 中包含 `debug`，则追加调试信息标志 `-g`。

#### 11. **`$(shell COMMAND)`**

- **作用**：`shell` 函数用于执行 Shell 命令，并将其输出作为字符串返回。
- **使用场景**：用于在 Makefile 中调用外部命令，并使用它们的输出。

**示例：**
```makefile
FILES := $(shell ls *.c)
```
使用 Shell 的 `ls` 命令列出当前目录中的所有 `.c` 文件。

#### 12. **`$(strip TEXT)`**

- **作用**：`strip` 函数用于删除字符串中的前后空白符（空格、制表符等）。
- **使用场景**：用于清理字符串的输入，防止不必要的空白符干扰处理。

**示例：**
```makefile
CLEAN_FILES := $(strip $(CLEAN_FILES))
```
清理 `CLEAN_FILES` 变量中的多余空格。

#### 总结

| 通配符 / 函数      | 描述                                         | 示例                          |
|-------------------|--------------------------------------------|-------------------------------|
| `*`               | 匹配任意长度的字符，用于文件名匹配           | `$(wildcard *.c)`              |
| `?`               | 匹配单个字符                                | `$(wildcard ?.c)`              |
| `[...]`           | 匹配方括号内的任意一个字符                  | `$(wildcard [ab]*.c)`          |
| `%`               | 在模式规则中使用，匹配目标和依赖中的模式部分 | `%.o: %.c`                     |
| `$(wildcard)`     | 查找符合某个模式的文件                      | `$(wildcard src/*.c)`          |
| `$(patsubst)`     | 模式替换                                    | `$(patsubst %.c, %.o, $(SRCS))` |
| `$(subst)`        | 简单字符串替换                              | `$(subst src/, build/, $(SRCS))` |
| `$(filter)`       | 筛选符合模式的字符串                        | `$(filter %.c, $(FILES))`      |
| `$(filter-out)`   | 排除符合模式的字符串                        | `$(filter-out %.c, $(FILES))`  |
| `$(findstring)`   | 在字符串中查找子串                          | `$(findstring debug, $(CFLAGS))` |
| `$(shell)`        | 执行 Shell 命令并返回结果                   | `$(shell ls *.c)`              |
| `$(strip)`        | 去除字符串中的空白                          | `$(strip $(CLEAN_FILES))`      |

这些通配符和函数为 Makefile 提供了强大的模式匹配和字符串处理能力，帮助你更高效地管理复杂的构建过程。