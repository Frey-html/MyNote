**静态模式规则**和**规则模式**（也称为普通模式规则）是 `Makefile` 中两种定义目标文件构建方式的规则。它们都有助于避免重复写类似的构建规则，但在使用方式、应用场景、灵活性等方面存在一定差异。

### 1. 静态模式规则与规则模式的定义

- **静态模式规则**：显式列出目标文件，并为这些目标文件定义模式规则。这种规则只适用于你明确列出的目标文件。
- **规则模式**：使用通配符 `%` 匹配一类文件，并定义一个适用于所有匹配目标的通用规则。它不需要显式列出具体的目标文件。

#### 静态模式规则语法：
```makefile
TARGETS: TARGET_PATTERN: DEPENDENCY_PATTERN
    COMMAND
```

- `TARGETS` 是你要生成的目标文件列表。
- `TARGET_PATTERN` 是目标文件的模式。
- `DEPENDENCY_PATTERN` 是依赖文件的模式。

#### 规则模式语法：
```makefile
TARGET_PATTERN: DEPENDENCY_PATTERN
    COMMAND
```

- `TARGET_PATTERN` 是目标文件的模式，使用 `%` 来匹配通用文件名部分。
- `DEPENDENCY_PATTERN` 是依赖文件的模式，`%` 在这里表示与目标文件相同的部分。

### 2. 静态模式规则与规则模式的相同点

- **简化规则定义**：两者都允许你通过通配符的方式来定义一类文件的构建规则，减少重复的显式规则。
- **通配符 `%`**：两者都使用 `%` 作为通配符，用来匹配文件名的通用部分。例如，`%.o` 可以匹配任何 `.o` 文件，`%.c` 匹配对应的 `.c` 文件。
- **自动化变量**：两者都可以使用 `make` 的自动化变量（如 `$@` 表示目标，`$<` 表示第一个依赖）来简化编译命令的编写。

### 3. 静态模式规则与规则模式的不同点

| **特点**            | **静态模式规则**                                      | **规则模式**                                        |
|---------------------|-------------------------------------------------------|----------------------------------------------------|
| **目标列出方式**    | 需要显式列出要生成的目标文件列表                      | 不需要显式列出目标文件，自动匹配目标文件            |
| **适用范围**        | 只适用于显式列出的目标文件                             | 适用于所有符合模式的目标文件                        |
| **灵活性**          | 控制更加精准，可以针对特定目标使用相同的构建规则       | 灵活，但针对性不强，作用范围较广                     |
| **文件依赖关系**    | 只能对显式列出的目标文件起作用，不能自动推导目标       | 自动推导目标与依赖文件的关系                        |
| **复杂依赖关系**    | 更适合处理目标文件与复杂依赖的组合                     | 适合处理简单的、普遍的文件依赖关系                   |
| **适用场景**        | 当你需要显式控制某些文件时，适合大规模项目             | 适合通用的、简单的项目，例如批量处理编译 `.c` 到 `.o` 文件 |
| **示例代码**        | $(objects): %. O: %. C                                   | %. O: %. C                                            |

#### 规则模式示例
规则模式的一个例子如下：

```makefile
%.o: %.c
    $(CC) -c $(CFLAGS) $< -o $@
```

这条规则模式告诉 `make`，所有的 `.o` 文件可以从对应的 `.c` 文件编译出来：
- `%.o`：匹配所有 `.o` 文件。
- `%.c`：匹配与目标 `.o` 文件同名的 `.c` 文件。
- `$<`：第一个依赖文件，即 `.c` 文件。
- `$@`：目标文件，即 `.o` 文件。

这个规则自动匹配任何符合 `.o` 的目标，并从对应的 `.c` 文件生成它。

#### 静态模式规则示例
静态模式规则与规则模式的主要区别是，它明确列出目标文件：

```makefile
objects = foo.o bar.o

$(objects): %.o: %.c
    $(CC) -c $(CFLAGS) $< -o $@
```

这表示：
- 目标文件 `foo.o` 和 `bar.o` 会根据模式规则生成。
- `foo.o` 从 `foo.c` 生成，`bar.o` 从 `bar.c` 生成。
- 静态模式规则限定了 `foo.o` 和 `bar.o` 是明确的目标，而不是所有的 `.o` 文件。

### 4. 使用场景比较

#### 规则模式的使用场景
规则模式更适合处理一类文件的编译规则，尤其是你需要根据文件扩展名进行大批量编译时：

```makefile
%.o: %.c
    $(CC) -c $(CFLAGS) $< -o $@
```

在这个规则中，所有 `.c` 文件都会被自动编译成 `.o` 文件，而无需显式列出每个文件。适用于简单的构建场景，如：
- 将多个 `.c` 文件批量编译成 `.o` 文件。
- 使用规则模式构建同类文件时更加简洁和自动化。

#### 静态模式规则的使用场景
静态模式规则适用于需要控制具体文件的编译方式或依赖关系，适合更复杂或定制化的构建规则：

```makefile
objects = foo.o bar.o

$(objects): %.o: %.c
    $(CC) -c $(CFLAGS) $< -o $@
```

这种规则模式更加精准。只会作用于指定的目标文件（如 `foo.o` 和 `bar.o`），不会自动应用于其他类似的文件。适合以下场景：
- 只想编译特定的 `.o` 文件，而不是所有的 `.o` 文件。
- 你希望对不同的目标文件进行更精确的控制。
  
### 5. 总结

- **规则模式**：适用于大批量、通用文件的构建。它不需要显式列出所有目标文件，而是通过通配符 `%` 来匹配目标文件，作用范围更广。
- **静态模式规则**：适用于更加精准和定制化的构建控制。它要求你显式列出目标文件列表，适合控制文件的复杂依赖关系。

两者的区别主要体现在**作用范围**和**目标控制的精确性**上。静态模式规则显式列出目标文件，适用于更精确的场景，而规则模式是通用的，适用于匹配规则较为简单的大批量文件处理。